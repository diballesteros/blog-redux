[{"_1":2},"routes/$slug",{"_3":4},"data",{"_5":6,"_26":27},"post",{"_7":8,"_9":10,"_11":12,"_13":14,"_15":16,"_18":19,"_20":21,"_22":23,"_24":25},"slug","how-to-mock-the-webshare-api-in-a-cypress-test","title","How to mock the Webshare API for a Cypress Test","date","","description","How to make a Cypress test to mock the WebShare API and test the after-effects correctly. In this guide, we will check in case it does and doesn't load.","categories",[17],"testing","coverImage","https://cdn.hashnode.com/res/hashnode/image/upload/v1651103456927/377xNku2p.png","published",true,"readingTime",2,"content","\r\n### Introduction\r\n\r\n[Cypress](https://www.cypress.io/) is a very robust testing framework with a ton of utilities. It has been my go-to option for all my side projects where I think extensive integration testing is necessary.\r\n\r\nIn one of my apps, I offer the ability to share images using the [WebShare](https://web.dev/web-share/) API. In order to properly test this, I decided to investigate how to test this using Cypress!\r\n\r\n### Brief rundown\r\n\r\nThe WebShare looks up native sharing functionalities the device may have for the selected data type. This could be anything ranging from text, URLs, images, or any number of other files. The application or method which will be used for sharing is called the share target.\r\n\r\nBefore validating if the selected data/file can be shared there is an additional function available in the navigator called canShare. This function will be the crux of our test as will test if this can be shared and validate what changes in UI are visible.\r\n\r\nHowever, the results of the WebShare API would not be something I would personally test for as it is outside the scope of the app. As a result, I much prefer mocking the desired results and checking what should happen in the UI!\r\n\r\n### Setting up Cypress\r\n\r\nCypress offers a way to access resources before it even loads with the onBeforeLoad utility. We can access this as we are visiting the main site. Let's look at this example below:\r\n\r\n![Mock Success](https://cdn.hashnode.com/res/hashnode/image/upload/v1649268093646/5kMEXdQgy.png)\r\n\r\nFirstly as it is not currently available in Firefox we only run the test on different browsers. Afterward in the onBeforeLoad function, we access the window object and completely replace the two functions we are attempting to mock. In this case the share and canShare. This way we can test the expected result with what should be displayed in the UI!\r\n\r\nBelow is a similar test but for the opposite case, for when a test fails:\r\n\r\n![Mock Error](https://cdn.hashnode.com/res/hashnode/image/upload/v1649268095075/7G-UviK7W.png)\r\n\r\nBonus tip: In earlier versions, the canShare utility was not defined in the Navigator Type and if for some reason you receive some error using Typescript and canShare, you can go ahead and extend it and brute force the type for the purposes of testing.\r\n\r\nExample:\r\n\r\n![Typescript Tip](https://cdn.hashnode.com/res/hashnode/image/upload/v1649268096464/qI_IuQZol.png)\r\n\r\nSmall disclaimer, the Webshare API and several of its utility functions do not have widespread compatibility.\r\n","recommendations",[28,36,44,50],{"_7":29,"_9":30,"_11":12,"_13":31,"_15":32,"_18":34,"_20":21,"_22":35},"what-is-imposter-syndrome-and-how-i-deal-with-it","What is imposter syndrome? And how I deal with it","Imposter syndrome is a common feeling to have as a software developer even if you've been doing it for years. I go over my personal experiences with it.",[33],"devlog","https://cdn.hashnode.com/res/hashnode/image/upload/v1651102112425/KKsbnfbCK.png",4,{"_7":37,"_9":38,"_11":12,"_13":39,"_15":40,"_18":42,"_20":21,"_22":43},"testing-a-reaction-application-updating-to-cypress-version-10","Testing a Reaction Application updating to Cypress Version 10","Testing a modern React application. In this part of the series, we go over how to update Cypress to version 10.",[17,41],"react","https://cdn.hashnode.com/res/hashnode/image/upload/v1651098470347/9coA_akWr.png",3,{"_7":45,"_9":46,"_11":12,"_13":47,"_15":48,"_18":42,"_20":21,"_22":49},"testing-a-react-application-working-with-codecov","Testing a React Application Working with Codecov","How to test a React web application and upload the test code coverage results to Codecov.",[17,41],5,{"_7":51,"_9":52,"_11":12,"_13":53,"_15":54,"_18":42,"_20":21,"_22":35},"testing-a-react-application-what-is-vitest","Testing a React Application What is Vitest?","The third part of a series of articles on how to test a React Application. I go over how Vitest and its syntax work in the simplest terms.",[17,41]]
